<div class="min-h-screen pb-24 overflow-x-hidden">
  <div class="max-w-[412px] mx-auto px-[6px]">
    <!-- Page 0: My Location -->
    @if (currentPage() === 0) {
      <!-- My Location Content -->
      <div class="pt-4">
        <!-- Save Location Button (only show if not already saved) -->
        @if (weatherData() && !hasSavedLocation()) {
          <div class="mb-4 text-center">
            <button 
              (click)="saveCurrentLocation()" 
              class="bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition-colors">
              Save This Location
            </button>
          </div>
        }
      </div>
    }

    <!-- Page 1: Saved Location -->
    @if (currentPage() === 1) {
      <!-- Saved Location Content -->
      <div class="pt-4">
        @if (hasSavedLocation()) {
          <div class="mb-4 text-center">
            <button 
              (click)="removeSavedLocation()" 
              class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition-colors">
              Remove Saved Location
            </button>
          </div>
        } @else {
          <div class="text-center py-12">
            <p class="text-navy-90 font-bold text-sm">No saved location</p>
            <p class="text-navy-50 font-bold text-xs mt-2">Save a location from the first or third page to see it here</p>
          </div>
        }
      </div>
    }

    <!-- Page 2: Search -->
    @if (currentPage() === 2) {
    <!-- Goat mascot and title side by side -->
    <div class="flex items-start gap-4 mb-[-40px] relative z-0">
      <!-- Goat mascot -->
      <div class="w-[114px] h-[171px] mt-[-14px]">
        <img 
          src="https://api.builder.io/api/v1/image/assets/TEMP/85335c987e9ae8ac6b1b4c944aca2140d49c0e3a?width=228" 
          alt="Goat mascot" 
          class="w-full h-full object-contain"
        />
      </div>

      <!-- Title -->
      <div class="flex-1 flex items-center mt-8">
        <h1 class="text-navy font-bold text-[36px] uppercase leading-[35px]" style="letter-spacing: -2.52px;">
          search the<br>weather
        </h1>
      </div>
    </div>

    <!-- Search Bar -->
    <div class="mb-4 relative z-10">
      <app-search-autocomplete
        placeholder="Search for a city"
        [disabled]="loading()"
        (placeSelected)="onPlaceSelected($event)"
      ></app-search-autocomplete>
    </div>
      
      <!-- Save Search Location Button (only show if search has results and no location is saved) -->
      @if (searchWeatherData() && !hasSavedLocation()) {
        <div class="mb-4 text-center">
          <button 
            (click)="saveSearchLocation()" 
            class="bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition-colors">
            Save This Location
          </button>
        </div>
      }
    }

    <!-- Page 3: Historical Weather -->
    @if (currentPage() === 3) {
      <!-- Goat mascot and title side by side -->
      <div class="flex items-start gap-4 mb-[-40px] relative z-0">
        <!-- Goat mascot -->
        <div class="w-[114px] h-[171px] mt-[-14px]">
          <img 
            src="https://api.builder.io/api/v1/image/assets/TEMP/85335c987e9ae8ac6b1b4c944aca2140d49c0e3a?width=228" 
            alt="Goat mascot" 
            class="w-full h-full object-contain"
          />
        </div>

        <!-- Title -->
        <div class="flex-1 flex items-center mt-8">
          <h1 class="text-navy font-bold text-[36px] uppercase leading-[35px]" style="letter-spacing: -2.52px;">
            historical<br>weather
          </h1>
        </div>
      </div>

      <div class="relative z-10">
        <!-- Calendar & Location Picker -->
        <div class="mb-4">
          <app-calendar-picker
            [selectedDate]="historicalSelectedDate()"
            [disabled]="loading()"
            (dateSelected)="onHistoricalDateSelected($event)"
            (placeSelected)="onHistoricalPlaceSelected($event)"
          ></app-calendar-picker>
        </div>

        <!-- Save Button (only show if weather data is loaded) -->
        @if (historicalWeatherData() && historicalLocation()) {
          <div class="mb-4 text-center">
            <button 
              (click)="saveHistoricalWeather()" 
              class="bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition-colors">
              Save This Weather
            </button>
          </div>
        }

        <!-- Saved Historical Weather List (only show when no search is active) -->
        @if (savedHistoricalWeather().length > 0 && !historicalWeatherData()) {
          <div class="mb-4">
            <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">Saved Weather</p>
            <div class="space-y-2">
              @for (weather of savedHistoricalWeather(); track weather.id) {
                <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-3">
                  <div class="flex items-center justify-between mb-1">
                    <h3 class="text-navy font-bold text-2xl uppercase" style="letter-spacing: -1.68px;">{{ weather.locationName }}</h3>
                    <p class="text-navy font-bold text-2xl" style="letter-spacing: -1.68px;">{{ getHistoricalWeatherTemperature(weather) }}</p>
                  </div>
                  <p class="text-navy-90 font-bold text-xs capitalize" style="letter-spacing: -0.11px;">{{ formatHistoricalDate(weather.dateObj) }}</p>
                  <p class="text-navy-90 font-bold text-xs capitalize mt-2 mb-3" style="letter-spacing: -0.11px;">{{ getHistoricalWeatherDescription(weather) }}</p>
                  
                  <!-- Remove button moved to bottom -->
                  <div class="flex justify-end">
                    <button 
                      (click)="removeHistoricalWeather(weather.id)"
                      class="w-6 h-6 bg-red-500/20 hover:bg-red-500/30 rounded-full flex items-center justify-center transition-colors">
                      <svg class="w-3 h-3 text-red-500" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9 3L3 9M3 3L9 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </button>
                  </div>
                </div>
              }
            </div>
          </div>
        }
      </div>
    }

    <!-- Loading State -->
    @if (loading()) {
      <div class="text-center py-12">
        <div class="inline-block w-12 h-12 border-4 border-cyan border-t-transparent rounded-full animate-spin"></div>
        <p class="text-navy-90 font-bold text-sm mt-4">Loading weather data...</p>
      </div>
    }

    <!-- Error State -->
    @if (error()) {
      <div class="bg-red-500/20 rounded-[20px] border-b border-red-500 p-4 mb-4">
        <p class="text-red-700 font-bold text-sm">{{ error() }}</p>
      </div>
    }

    <!-- Location Permission Denied State -->
    @if (locationPermissionDenied()) {
      <div class="bg-amber-500/20 rounded-[20px] border-b border-amber-500 p-4 mb-4">
        <p class="text-amber-700 font-bold text-sm mb-2">Location access denied</p>
        <p class="text-amber-600 font-bold text-xs mb-3">We can't access your location to show local weather. Please allow location access in your browser settings or search for a city manually.</p>
        <button 
          (click)="retryLocationAccess()" 
          class="bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition-colors">
          Try Again
        </button>
      </div>
    }

    <!-- Weather Content for My Location (Page 0) -->
    @if (currentPage() === 0 && weatherData() && !loading()) {
      <!-- Header -->
      <div class="text-center mb-4">
        <p class="text-navy-90 font-bold text-sm uppercase tracking-tight" style="letter-spacing: -1.05px;">
          @if (isGeolocationSupported() && !locationPermissionDenied()) {
            MY LOCATION
          } @else {
            CURRENT WEATHER
          }
        </p>
        <h1 class="text-navy font-bold text-4xl uppercase" style="letter-spacing: -2.52px;">{{ getLocationDisplayName() }}</h1>
      </div>

      <!-- Current Weather Card -->
      <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4 relative">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-4">
            <img 
              [src]="getWeatherIconUrl(weatherData()!.weather.icon)" 
              [alt]="weatherData()!.weather.description" 
              class="w-20 h-20 object-contain"
            />
            <div>
              <p class="text-navy-90 font-bold text-4xl" style="letter-spacing: -2.52px;">{{ weatherData()!.weather.temperature }}°C</p>
              <p class="text-navy-90 font-bold text-sm" style="letter-spacing: -1.05px;">{{ weatherData()!.weather.description }}</p>
              <p class="text-navy-90 font-bold text-2xl" style="letter-spacing: -1.68px;">H:{{ weatherData()!.weather.tempMax }}°</p>
              <p class="text-navy-90 font-bold text-2xl" style="letter-spacing: -1.68px;">L:{{ weatherData()!.weather.tempMin }}°</p>
            </div>
          </div>
          <img 
            [src]="getCurrentWeatherGoatImage()" 
            alt="Weather goat" 
            class="w-[142px] h-auto absolute right-4 top-8"
          />
        </div>
      </div>

      <!-- 5-Day Forecast -->
      @if (forecastData()) {
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">5-day forecast</p>
          
          <div class="space-y-0">
            @for (day of forecastData()!.forecast; track day.date; let i = $index; let isLast = $last) {
              <div class="flex items-center justify-between py-2" [class.border-b]="!isLast" [class.border-white/10]="!isLast">
                <span class="text-navy-50 font-bold text-sm w-12">{{ getDayLabel(i) }}</span>
                <img [src]="getWeatherIconUrl(day.weather.icon)" [alt]="day.weather.description" class="w-7 h-7" />
                <span class="text-navy font-bold text-sm"><span class="text-red-500/50">{{ day.temperature.max }}°</span> <span class="text-navy-50">/</span> {{ day.temperature.min }}°</span>
                <span class="text-navy-50 font-bold text-sm flex-1 text-center lowercase">{{ day.weather.description }}</span>
                <span class="text-goat-sky font-bold text-sm">{{ day.precipitationChance }}%</span>
                <svg class="w-5 h-5" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <defs>
                    <linearGradient [attr.id]="'paint0_linear_' + i" x1="11" y1="1.375" x2="11" y2="20.625" gradientUnits="userSpaceOnUse">
                      <stop stop-color="#95B6F6"/>
                      <stop offset="1" stop-color="#5193DE"/>
                    </linearGradient>
                  </defs>
                  <path fill-rule="evenodd" clip-rule="evenodd" d="M1.375 8.9375C1.375 11.9369 3.05895 14.5285 5.5 15.7511V14.1627C3.85701 13.073 2.75 11.1575 2.75 8.9375C2.75 5.47282 5.44623 2.75 8.6682 2.75C11.4014 2.75 13.7563 4.7094 14.4078 7.41891L14.4099 7.41807C14.5019 7.79401 14.5606 8.18377 14.5824 8.58377C15.0108 8.36906 15.4874 8.25001 15.9839 8.25001C17.7411 8.25001 19.25 9.7416 19.25 11.6875C19.25 12.8635 18.6989 13.8735 17.875 14.4887V16.0837C19.4956 15.3329 20.625 13.647 20.625 11.6875C20.625 9.02963 18.5471 6.87501 15.9839 6.87501C15.885 6.87501 15.7868 6.87821 15.6895 6.88453C14.8267 3.70546 12.0099 1.375 8.6682 1.375C4.64028 1.375 1.375 4.76085 1.375 8.9375Z" [attr.fill]="'url(#paint0_linear_' + i + ')'"/>
                </svg>
              </div>
            }
          </div>
        </div>
      }

      <!-- Precipitation Map -->
      <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4">
        <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">Precipitation</p>
        <div class="w-full h-[259px] rounded-[20px] overflow-hidden">
          <iframe 
            [src]="getWindyMapUrl()"
            width="100%" 
            height="100%" 
            frameborder="0"
            class="rounded-[20px]"
            allowfullscreen>
          </iframe>
        </div>
      </div>

      <!-- Info Grid Row 1 -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <!-- Feels Like -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">FEELS LIKE</p>
          <p class="text-navy-50 font-bold text-4xl mb-1" style="letter-spacing: -0.36px;">{{ weatherData()!.weather.feelsLike }}°</p>
          <p class="text-navy-50 font-bold text-sm lowercase mb-2">actual: {{ weatherData()!.weather.temperature }}°</p>
          <div class="flex items-center gap-2 mb-2">
            <p class="text-navy-50 font-bold text-sm lowercase">{{ Math.abs(weatherData()!.weather.temperature - weatherData()!.weather.feelsLike) }}°</p>
            <svg class="w-3 h-3" [class.rotate-90]="weatherData()!.weather.feelsLike < weatherData()!.weather.temperature" [class.-rotate-90]="weatherData()!.weather.feelsLike > weatherData()!.weather.temperature" viewBox="0 0 12 21" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M7 1C7 0.447715 6.55228 0 6 0C5.44772 0 5 0.447715 5 1H6L7 1ZM6 20.7735L11.7735 15L6 9.2265L0.226497 15L6 20.7735ZM6 1H5L5 15H6H7L7 1L6 1Z" fill="#46738B"/>
            </svg>
          </div>
          <div class="h-px bg-gradient-to-r from-navy to-cyan-light/40 mb-2"></div>
          <p class="text-navy-50 font-bold text-xs lowercase leading-tight">
            {{ weatherData()!.weather.feelsLike < weatherData()!.weather.temperature ? 'It feels colder than the actual temperature' : 'It feels warmer than the actual temperature' }}
          </p>
        </div>

        <!-- Elevation -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">ELEVATION</p>
          <p class="text-navy-50 font-bold text-4xl mb-1" style="letter-spacing: -0.36px;">{{ weatherData()!.elevation.elevation || 'N/A' }}</p>
          <p class="text-navy-50 font-bold text-sm lowercase mb-2">meter</p>
          <p class="text-navy-50 font-bold text-sm lowercase leading-tight mb-1">above sea level</p>
          <p class="text-navy-50 font-bold text-xs uppercase leading-tight">{{ formatCoordinates(weatherData()!.location.lat, weatherData()!.location.lng).lat }}<br>{{ formatCoordinates(weatherData()!.location.lat, weatherData()!.location.lng).lng }}</p>
        </div>
      </div>

      <!-- Sunrise and Sunset -->
      <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4 relative">
        <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">SUNRISE AND SUNSET</p>
        <div class="flex items-center justify-between mb-4">
          <div>
            <p class="text-navy-50 font-bold text-4xl" style="letter-spacing: -0.36px;">{{ formatTime(weatherData()!.weather.sunrise) }}</p>
            <p class="text-navy-50 font-bold text-xs uppercase" style="letter-spacing: -0.11px;">Sunrise</p>
          </div>
          <div class="text-right">
            <p class="text-navy-50 font-bold text-4xl" style="letter-spacing: -0.36px;">{{ formatTime(weatherData()!.weather.sunset) }}</p>
            <p class="text-navy-50 font-bold text-xs uppercase" style="letter-spacing: -0.11px;">Sunset</p>
          </div>
        </div>
      
      <!-- Sun Arc Visualization -->
      <div class="relative mt-4 h-20">
        <svg class="w-full h-full" viewBox="0 0 400 80" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
          <!-- Background arc path -->
          <path 
            d="M 20 70 Q 200 20 380 70" 
            stroke="#E5E7EB" 
            stroke-width="2" 
            fill="none"
            stroke-linecap="round"
            opacity="0.3"
          />
          
          <!-- Sun arc path with gradient -->
          <path 
            d="M 20 70 Q 200 20 380 70" 
            stroke="url(#sunArcGradient)" 
            stroke-width="4" 
            fill="none"
            stroke-linecap="round"
          />
          
          <!-- Sun position indicator -->
          <circle 
            [attr.cx]="20 + getSunPosition().progress * 360" 
            [attr.cy]="70 - Math.sin(getSunPosition().progress * Math.PI) * 25" 
            r="4" 
            fill="#FFD700"
            stroke="#FFFFFF"
            stroke-width="2"
            class="drop-shadow-lg"
          />
          
          <!-- Gradient definitions -->
          <defs>
            <linearGradient id="sunArcGradient" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" style="stop-color:#3B82F6;stop-opacity:1" />
              <stop offset="25%" style="stop-color:#60A5FA;stop-opacity:1" />
              <stop offset="50%" style="stop-color:#FBBF24;stop-opacity:1" />
              <stop offset="75%" style="stop-color:#F59E0B;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#EF4444;stop-opacity:1" />
            </linearGradient>
          </defs>
        </svg>
      </div>
    </div>

    <!-- UV Index -->
    <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4">
      <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">UV INDEX</p>
      <div class="mb-6">
        <p class="text-navy-50 font-bold text-4xl leading-none" style="letter-spacing: -0.36px;">{{ getUVIndex() }}</p>
        <p class="text-navy-50 font-bold text-2xl lowercase" style="letter-spacing: -0.24px;">{{ getUVDescription(getUVIndex()) }}</p>
      </div>
      
      <!-- UV Index gradient bar -->
      <div class="relative">
        <svg class="w-full h-4" viewBox="0 0 365 18" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0.339746 9L9 17.6603L17.6603 9L9 0.339746L0.339746 9ZM364.66 9L356 0.339746L347.34 9L356 17.6603L364.66 9ZM9 9V10.5H356V9V7.5H9V9Z" fill="url(#paint0_linear_uv)"/>
          
          <!-- UV indicator -->
          <circle 
            [attr.cx]="9 + (getUVPosition(getUVIndex()) / 100) * 347" 
            cy="9" 
            r="7" 
            fill="#26658C"
            stroke="#FFFFFF"
            stroke-width="3"
            class="drop-shadow-lg"
          />
          
          <defs>
            <linearGradient id="paint0_linear_uv" x1="9" y1="17.5" x2="356" y2="17.5" gradientUnits="userSpaceOnUse">
              <stop stop-color="#268C48"/>
              <stop offset="0.0865385" stop-color="#C09A00"/>
              <stop offset="0.289568" stop-color="#CF5701"/>
              <stop offset="0.495192" stop-color="#D33335"/>
              <stop offset="0.732416" stop-color="#D8000B"/>
              <stop offset="0.913462" stop-color="#C00087"/>
              <stop offset="1" stop-color="#290140" stop-opacity="0.88"/>
            </linearGradient>
          </defs>
        </svg>
      </div>
    </div>

      <!-- Info Grid Row 2 -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <!-- Visibility -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">VISIBILITY</p>
          <p class="text-navy-50 font-bold text-4xl mb-8" style="letter-spacing: -0.36px;">{{ weatherData()!.weather.visibility }} km</p>
          <p class="text-navy-50 font-bold text-sm lowercase leading-tight">{{ weatherData()!.weather.visibility > 10 ? 'Perfectly clear view.' : 'Limited visibility.' }}</p>
        </div>

        <!-- Precipitation Chances -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">CLOUDINESS</p>
          <div class="mb-2">
            <p class="text-navy-50 font-bold text-4xl leading-none" style="letter-spacing: -0.36px;">{{ getCloudiness() }}%</p>
            <p class="text-navy-50 font-bold text-2xl" style="letter-spacing: -0.24px;">CLOUDS</p>
          </div>
        </div>
      </div>

      <!-- Info Grid Row 3 -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <!-- Pressure -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">PRESSURE</p>
          <p class="text-navy-50 font-bold text-4xl mb-12" style="letter-spacing: -0.36px;">{{ weatherData()!.weather.pressure }}</p>
          <p class="text-navy-50 font-bold text-sm lowercase text-right">mbar</p>
        </div>

        <!-- Humidity -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">HUMIDITY</p>
          <p class="text-navy-50 font-bold text-4xl mb-8" style="letter-spacing: -0.36px;">{{ weatherData()!.weather.humidity }}%</p>
          <p class="text-navy-50 font-bold text-sm lowercase leading-tight">{{ weatherData()!.weather.humidity > 70 ? 'high humidity' : 'moderate humidity' }}</p>
        </div>
      </div>

    }

    <!-- Weather Content for Saved Location (Page 1) -->
    @if (currentPage() === 1 && savedWeatherData() && !loading()) {
      <!-- Header -->
      <div class="text-center mb-4">
        <p class="text-navy-90 font-bold text-sm uppercase tracking-tight" style="letter-spacing: -1.05px;">SAVED LOCATION</p>
        <h1 class="text-navy font-bold text-4xl uppercase" style="letter-spacing: -2.52px;">{{ getSavedLocationDisplayName() }}</h1>
      </div>

      <!-- Current Weather Card -->
      <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4 relative">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-4">
            <img 
              [src]="getWeatherIconUrl(savedWeatherData()!.weather.icon)" 
              [alt]="savedWeatherData()!.weather.description" 
              class="w-20 h-20 object-contain"
            />
            <div>
              <p class="text-navy-90 font-bold text-4xl" style="letter-spacing: -2.52px;">{{ savedWeatherData()!.weather.temperature }}°C</p>
              <p class="text-navy-90 font-bold text-sm" style="letter-spacing: -1.05px;">{{ savedWeatherData()!.weather.description }}</p>
              <p class="text-navy-90 font-bold text-2xl" style="letter-spacing: -1.68px;">H:{{ savedWeatherData()!.weather.tempMax }}°</p>
              <p class="text-navy-90 font-bold text-2xl" style="letter-spacing: -1.68px;">L:{{ savedWeatherData()!.weather.tempMin }}°</p>
            </div>
          </div>
          <img 
            [src]="getSavedWeatherGoatImage()" 
            alt="Weather goat" 
            class="w-[142px] h-auto absolute right-4 top-8"
          />
        </div>
      </div>

      <!-- 5-Day Forecast for Saved Location -->
      @if (savedForecastData()) {
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">5-day forecast</p>
          
          <div class="space-y-0">
            @for (day of savedForecastData()!.forecast; track day.date; let i = $index; let isLast = $last) {
              <div class="flex items-center justify-between py-2" [class.border-b]="!isLast" [class.border-white/10]="!isLast">
                <span class="text-navy-50 font-bold text-sm w-12">{{ getDayLabel(i) }}</span>
                <img [src]="getWeatherIconUrl(day.weather.icon)" [alt]="day.weather.description" class="w-7 h-7" />
                <span class="text-navy font-bold text-sm"><span class="text-red-500/50">{{ day.temperature.max }}°</span> <span class="text-navy-50">/</span> {{ day.temperature.min }}°</span>
                <span class="text-navy-50 font-bold text-sm flex-1 text-center lowercase">{{ day.weather.description }}</span>
                <span class="text-goat-sky font-bold text-sm">{{ day.precipitationChance }}%</span>
                <svg class="w-5 h-5" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <defs>
                    <linearGradient [attr.id]="'paint0_linear_saved_' + i" x1="11" y1="1.375" x2="11" y2="20.625" gradientUnits="userSpaceOnUse">
                      <stop stop-color="#95B6F6"/>
                      <stop offset="1" stop-color="#5193DE"/>
                    </linearGradient>
                  </defs>
                  <path fill-rule="evenodd" clip-rule="evenodd" d="M1.375 8.9375C1.375 11.9369 3.05895 14.5285 5.5 15.7511V14.1627C3.85701 13.073 2.75 11.1575 2.75 8.9375C2.75 5.47282 5.44623 2.75 8.6682 2.75C11.4014 2.75 13.7563 4.7094 14.4078 7.41891L14.4099 7.41807C14.5019 7.79401 14.5606 8.18377 14.5824 8.58377C15.0108 8.36906 15.4874 8.25001 15.9839 8.25001C17.7411 8.25001 19.25 9.7416 19.25 11.6875C19.25 12.8635 18.6989 13.8735 17.875 14.4887V16.0837C19.4956 15.3329 20.625 13.647 20.625 11.6875C20.625 9.02963 18.5471 6.87501 15.9839 6.87501C15.885 6.87501 15.7868 6.87821 15.6895 6.88453C14.8267 3.70546 12.0099 1.375 8.6682 1.375C4.64028 1.375 1.375 4.76085 1.375 8.9375Z" [attr.fill]="'url(#paint0_linear_saved_' + i + ')'"/>
                </svg>
              </div>
            }
          </div>
        </div>
      }

      <!-- Precipitation Map for Saved Location -->
      <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4">
        <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">Precipitation</p>
        <div class="w-full h-[259px] rounded-[20px] overflow-hidden">
          <iframe 
            [src]="getSavedWindyMapUrl()"
            width="100%" 
            height="100%" 
            frameborder="0"
            class="rounded-[20px]"
            allowfullscreen>
          </iframe>
        </div>
      </div>

      <!-- Info Grid Row 1 for Saved Location -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <!-- Feels Like -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">FEELS LIKE</p>
          <p class="text-navy-50 font-bold text-4xl mb-1" style="letter-spacing: -0.36px;">{{ savedWeatherData()!.weather.feelsLike }}°</p>
          <p class="text-navy-50 font-bold text-sm lowercase mb-2">actual: {{ savedWeatherData()!.weather.temperature }}°</p>
          <div class="flex items-center gap-2 mb-2">
            <p class="text-navy-50 font-bold text-sm lowercase">{{ Math.abs(savedWeatherData()!.weather.temperature - savedWeatherData()!.weather.feelsLike) }}°</p>
            <svg class="w-3 h-3" [class.rotate-90]="savedWeatherData()!.weather.feelsLike < savedWeatherData()!.weather.temperature" [class.-rotate-90]="savedWeatherData()!.weather.feelsLike > savedWeatherData()!.weather.temperature" viewBox="0 0 12 21" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M7 1C7 0.447715 6.55228 0 6 0C5.44772 0 5 0.447715 5 1H6L7 1ZM6 20.7735L11.7735 15L6 9.2265L0.226497 15L6 20.7735ZM6 1H5L5 15H6H7L7 1L6 1Z" fill="#46738B"/>
            </svg>
          </div>
          <div class="h-px bg-gradient-to-r from-navy to-cyan-light/40 mb-2"></div>
          <p class="text-navy-50 font-bold text-xs lowercase leading-tight">
            {{ savedWeatherData()!.weather.feelsLike < savedWeatherData()!.weather.temperature ? 'It feels colder than the actual temperature' : 'It feels warmer than the actual temperature' }}
          </p>
        </div>

        <!-- Elevation -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">ELEVATION</p>
          <p class="text-navy-50 font-bold text-4xl mb-1" style="letter-spacing: -0.36px;">{{ savedWeatherData()!.elevation.elevation || 'N/A' }}</p>
          <p class="text-navy-50 font-bold text-sm lowercase mb-2">meter</p>
          <p class="text-navy-50 font-bold text-sm lowercase leading-tight mb-1">above sea level</p>
          <p class="text-navy-50 font-bold text-xs uppercase leading-tight">{{ formatCoordinates(savedWeatherData()!.location.lat, savedWeatherData()!.location.lng).lat }}<br>{{ formatCoordinates(savedWeatherData()!.location.lat, savedWeatherData()!.location.lng).lng }}</p>
        </div>
      </div>

      <!-- Sunrise and Sunset for Saved Location -->
      <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4 relative">
        <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">SUNRISE AND SUNSET</p>
        <div class="flex items-center justify-between mb-4">
          <div>
            <p class="text-navy-50 font-bold text-4xl" style="letter-spacing: -0.36px;">{{ formatTime(savedWeatherData()!.weather.sunrise) }}</p>
            <p class="text-navy-50 font-bold text-xs uppercase" style="letter-spacing: -0.11px;">Sunrise</p>
          </div>
          <div class="text-right">
            <p class="text-navy-50 font-bold text-4xl" style="letter-spacing: -0.36px;">{{ formatTime(savedWeatherData()!.weather.sunset) }}</p>
            <p class="text-navy-50 font-bold text-xs uppercase" style="letter-spacing: -0.11px;">Sunset</p>
          </div>
        </div>
      
      <!-- Sun Arc Visualization for Saved Location -->
      <div class="relative mt-4 h-20">
        <svg class="w-full h-full" viewBox="0 0 400 80" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
          <!-- Background arc path -->
          <path 
            d="M 20 70 Q 200 20 380 70" 
            stroke="#E5E7EB" 
            stroke-width="2" 
            fill="none"
            stroke-linecap="round"
            opacity="0.3"
          />
          
          <!-- Sun arc path with gradient -->
          <path 
            d="M 20 70 Q 200 20 380 70" 
            stroke="url(#sunArcGradientSaved)" 
            stroke-width="4" 
            fill="none"
            stroke-linecap="round"
          />
          
          <!-- Sun position indicator -->
          <circle 
            [attr.cx]="20 + getSavedSunPosition().progress * 360" 
            [attr.cy]="70 - Math.sin(getSavedSunPosition().progress * Math.PI) * 25" 
            r="4" 
            fill="#FFD700"
            stroke="#FFFFFF"
            stroke-width="2"
            class="drop-shadow-lg"
          />
          
          <!-- Gradient definitions -->
          <defs>
            <linearGradient id="sunArcGradientSaved" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" style="stop-color:#3B82F6;stop-opacity:1" />
              <stop offset="25%" style="stop-color:#60A5FA;stop-opacity:1" />
              <stop offset="50%" style="stop-color:#FBBF24;stop-opacity:1" />
              <stop offset="75%" style="stop-color:#F59E0B;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#EF4444;stop-opacity:1" />
            </linearGradient>
          </defs>
        </svg>
      </div>
    </div>

    <!-- UV Index for Saved Location -->
    <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4">
      <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">UV INDEX</p>
      <div class="mb-6">
        <p class="text-navy-50 font-bold text-4xl leading-none" style="letter-spacing: -0.36px;">{{ getSavedUVIndex() }}</p>
        <p class="text-navy-50 font-bold text-2xl lowercase" style="letter-spacing: -0.24px;">{{ getUVDescription(getSavedUVIndex()) }}</p>
      </div>
      
      <!-- UV Index gradient bar -->
      <div class="relative">
        <svg class="w-full h-4" viewBox="0 0 365 18" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0.339746 9L9 17.6603L17.6603 9L9 0.339746L0.339746 9ZM364.66 9L356 0.339746L347.34 9L356 17.6603L364.66 9ZM9 9V10.5H356V9V7.5H9V9Z" fill="url(#paint0_linear_uv_saved)"/>
          
          <!-- UV indicator -->
          <circle 
            [attr.cx]="9 + (getUVPosition(getSavedUVIndex()) / 100) * 347" 
            cy="9" 
            r="7" 
            fill="#26658C"
            stroke="#FFFFFF"
            stroke-width="3"
            class="drop-shadow-lg"
          />
          
          <defs>
            <linearGradient id="paint0_linear_uv_saved" x1="9" y1="17.5" x2="356" y2="17.5" gradientUnits="userSpaceOnUse">
              <stop stop-color="#268C48"/>
              <stop offset="0.0865385" stop-color="#C09A00"/>
              <stop offset="0.289568" stop-color="#CF5701"/>
              <stop offset="0.495192" stop-color="#D33335"/>
              <stop offset="0.732416" stop-color="#D8000B"/>
              <stop offset="0.913462" stop-color="#C00087"/>
              <stop offset="1" stop-color="#290140" stop-opacity="0.88"/>
            </linearGradient>
          </defs>
        </svg>
      </div>
    </div>

      <!-- Info Grid Row 2 for Saved Location -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <!-- Visibility -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">VISIBILITY</p>
          <p class="text-navy-50 font-bold text-4xl mb-8" style="letter-spacing: -0.36px;">{{ savedWeatherData()!.weather.visibility }} km</p>
          <p class="text-navy-50 font-bold text-sm lowercase leading-tight">{{ savedWeatherData()!.weather.visibility > 10 ? 'Perfectly clear view.' : 'Limited visibility.' }}</p>
        </div>

        <!-- Precipitation Chances -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">CLOUDINESS</p>
          <div class="mb-2">
            <p class="text-navy-50 font-bold text-4xl leading-none" style="letter-spacing: -0.36px;">{{ getSavedCloudiness() }}%</p>
            <p class="text-navy-50 font-bold text-2xl" style="letter-spacing: -0.24px;">CLOUDS</p>
          </div>
        </div>
      </div>

      <!-- Info Grid Row 3 for Saved Location -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <!-- Pressure -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">PRESSURE</p>
          <p class="text-navy-50 font-bold text-4xl mb-12" style="letter-spacing: -0.36px;">{{ savedWeatherData()!.weather.pressure }}</p>
          <p class="text-navy-50 font-bold text-sm lowercase text-right">mbar</p>
        </div>

        <!-- Humidity -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">HUMIDITY</p>
          <p class="text-navy-50 font-bold text-4xl mb-8" style="letter-spacing: -0.36px;">{{ savedWeatherData()!.weather.humidity }}%</p>
          <p class="text-navy-50 font-bold text-sm lowercase leading-tight">{{ savedWeatherData()!.weather.humidity > 70 ? 'high humidity' : 'moderate humidity' }}</p>
        </div>
      </div>
    }

    <!-- Weather Content for Search (Page 2) -->
    @if (currentPage() === 2 && searchWeatherData() && !loading()) {
      <!-- Header -->
      <div class="text-center mb-4">
        <p class="text-navy-90 font-bold text-sm uppercase tracking-tight" style="letter-spacing: -1.05px;">SEARCHED LOCATION</p>
        <h1 class="text-navy font-bold text-4xl uppercase" style="letter-spacing: -2.52px;">{{ getSearchLocationDisplayName() }}</h1>
      </div>

      <!-- Current Weather Card -->
      <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4 relative">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-4">
            <img 
              [src]="getWeatherIconUrl(searchWeatherData()!.weather.icon)" 
              [alt]="searchWeatherData()!.weather.description" 
              class="w-20 h-20 object-contain"
            />
            <div>
              <p class="text-navy-90 font-bold text-4xl" style="letter-spacing: -2.52px;">{{ searchWeatherData()!.weather.temperature }}°C</p>
              <p class="text-navy-90 font-bold text-sm" style="letter-spacing: -1.05px;">{{ searchWeatherData()!.weather.description }}</p>
              <p class="text-navy-90 font-bold text-2xl" style="letter-spacing: -1.68px;">H:{{ searchWeatherData()!.weather.tempMax }}°</p>
              <p class="text-navy-90 font-bold text-2xl" style="letter-spacing: -1.68px;">L:{{ searchWeatherData()!.weather.tempMin }}°</p>
            </div>
          </div>
          <img 
            [src]="getSearchWeatherGoatImage()" 
            alt="Weather goat" 
            class="w-[142px] h-auto absolute right-4 top-8"
          />
        </div>
      </div>

      <!-- 5-Day Forecast for Search -->
      @if (searchForecastData()) {
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">5-day forecast</p>
          
          <div class="space-y-0">
            @for (day of searchForecastData()!.forecast; track day.date; let i = $index; let isLast = $last) {
              <div class="flex items-center justify-between py-2" [class.border-b]="!isLast" [class.border-white/10]="!isLast">
                <span class="text-navy-50 font-bold text-sm w-12">{{ getDayLabel(i) }}</span>
                <img [src]="getWeatherIconUrl(day.weather.icon)" [alt]="day.weather.description" class="w-7 h-7" />
                <span class="text-navy font-bold text-sm"><span class="text-red-500/50">{{ day.temperature.max }}°</span> <span class="text-navy-50">/</span> {{ day.temperature.min }}°</span>
                <span class="text-navy-50 font-bold text-sm flex-1 text-center lowercase">{{ day.weather.description }}</span>
                <span class="text-goat-sky font-bold text-sm">{{ day.precipitationChance }}%</span>
                <svg class="w-5 h-5" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <defs>
                    <linearGradient [attr.id]="'paint0_linear_search_' + i" x1="11" y1="1.375" x2="11" y2="20.625" gradientUnits="userSpaceOnUse">
                      <stop stop-color="#95B6F6"/>
                      <stop offset="1" stop-color="#5193DE"/>
                    </linearGradient>
                  </defs>
                  <path fill-rule="evenodd" clip-rule="evenodd" d="M1.375 8.9375C1.375 11.9369 3.05895 14.5285 5.5 15.7511V14.1627C3.85701 13.073 2.75 11.1575 2.75 8.9375C2.75 5.47282 5.44623 2.75 8.6682 2.75C11.4014 2.75 13.7563 4.7094 14.4078 7.41891L14.4099 7.41807C14.5019 7.79401 14.5606 8.18377 14.5824 8.58377C15.0108 8.36906 15.4874 8.25001 15.9839 8.25001C17.7411 8.25001 19.25 9.7416 19.25 11.6875C19.25 12.8635 18.6989 13.8735 17.875 14.4887V16.0837C19.4956 15.3329 20.625 13.647 20.625 11.6875C20.625 9.02963 18.5471 6.87501 15.9839 6.87501C15.885 6.87501 15.7868 6.87821 15.6895 6.88453C14.8267 3.70546 12.0099 1.375 8.6682 1.375C4.64028 1.375 1.375 4.76085 1.375 8.9375Z" [attr.fill]="'url(#paint0_linear_search_' + i + ')'"/>
                </svg>
              </div>
            }
          </div>
        </div>
      }

      <!-- Precipitation Map for Search -->
      <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4">
        <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">Precipitation</p>
        <div class="w-full h-[259px] rounded-[20px] overflow-hidden">
          <iframe 
            [src]="getSearchWindyMapUrl()"
            width="100%" 
            height="100%" 
            frameborder="0"
            class="rounded-[20px]"
            allowfullscreen>
          </iframe>
        </div>
      </div>

      <!-- Info Grid Row 1 for Search -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <!-- Feels Like -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">FEELS LIKE</p>
          <p class="text-navy-50 font-bold text-4xl mb-1" style="letter-spacing: -0.36px;">{{ searchWeatherData()!.weather.feelsLike }}°</p>
          <p class="text-navy-50 font-bold text-sm lowercase mb-2">actual: {{ searchWeatherData()!.weather.temperature }}°</p>
          <div class="flex items-center gap-2 mb-2">
            <p class="text-navy-50 font-bold text-sm lowercase">{{ Math.abs(searchWeatherData()!.weather.temperature - searchWeatherData()!.weather.feelsLike) }}°</p>
            <svg class="w-3 h-3" [class.rotate-90]="searchWeatherData()!.weather.feelsLike < searchWeatherData()!.weather.temperature" [class.-rotate-90]="searchWeatherData()!.weather.feelsLike > searchWeatherData()!.weather.temperature" viewBox="0 0 12 21" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M7 1C7 0.447715 6.55228 0 6 0C5.44772 0 5 0.447715 5 1H6L7 1ZM6 20.7735L11.7735 15L6 9.2265L0.226497 15L6 20.7735ZM6 1H5L5 15H6H7L7 1L6 1Z" fill="#46738B"/>
            </svg>
          </div>
          <div class="h-px bg-gradient-to-r from-navy to-cyan-light/40 mb-2"></div>
          <p class="text-navy-50 font-bold text-xs lowercase leading-tight">
            {{ searchWeatherData()!.weather.feelsLike < searchWeatherData()!.weather.temperature ? 'It feels colder than the actual temperature' : 'It feels warmer than the actual temperature' }}
          </p>
        </div>

        <!-- Elevation -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">ELEVATION</p>
          <p class="text-navy-50 font-bold text-4xl mb-1" style="letter-spacing: -0.36px;">{{ searchWeatherData()!.elevation.elevation || 'N/A' }}</p>
          <p class="text-navy-50 font-bold text-sm lowercase mb-2">meter</p>
          <p class="text-navy-50 font-bold text-sm lowercase leading-tight mb-1">above sea level</p>
          <p class="text-navy-50 font-bold text-xs uppercase leading-tight">{{ formatCoordinates(searchWeatherData()!.location.lat, searchWeatherData()!.location.lng).lat }}<br>{{ formatCoordinates(searchWeatherData()!.location.lat, searchWeatherData()!.location.lng).lng }}</p>
        </div>
      </div>

      <!-- Sunrise and Sunset for Search -->
      <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4 relative">
        <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">SUNRISE AND SUNSET</p>
        <div class="flex items-center justify-between mb-4">
          <div>
            <p class="text-navy-50 font-bold text-4xl" style="letter-spacing: -0.36px;">{{ formatTime(searchWeatherData()!.weather.sunrise) }}</p>
            <p class="text-navy-50 font-bold text-xs uppercase" style="letter-spacing: -0.11px;">Sunrise</p>
          </div>
          <div class="text-right">
            <p class="text-navy-50 font-bold text-4xl" style="letter-spacing: -0.36px;">{{ formatTime(searchWeatherData()!.weather.sunset) }}</p>
            <p class="text-navy-50 font-bold text-xs uppercase" style="letter-spacing: -0.11px;">Sunset</p>
          </div>
        </div>
      
      <!-- Sun Arc Visualization for Search Location -->
      <div class="relative mt-4 h-20">
        <svg class="w-full h-full" viewBox="0 0 400 80" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
          <!-- Background arc path -->
          <path 
            d="M 20 70 Q 200 20 380 70" 
            stroke="#E5E7EB" 
            stroke-width="2" 
            fill="none"
            stroke-linecap="round"
            opacity="0.3"
          />
          
          <!-- Sun arc path with gradient -->
          <path 
            d="M 20 70 Q 200 20 380 70" 
            stroke="url(#sunArcGradientSearch)" 
            stroke-width="4" 
            fill="none"
            stroke-linecap="round"
          />
          
          <!-- Sun position indicator -->
          <circle 
            [attr.cx]="20 + getSearchSunPosition().progress * 360" 
            [attr.cy]="70 - Math.sin(getSearchSunPosition().progress * Math.PI) * 25" 
            r="4" 
            fill="#FFD700"
            stroke="#FFFFFF"
            stroke-width="2"
            class="drop-shadow-lg"
          />
          
          <!-- Gradient definitions -->
          <defs>
            <linearGradient id="sunArcGradientSearch" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" style="stop-color:#3B82F6;stop-opacity:1" />
              <stop offset="25%" style="stop-color:#60A5FA;stop-opacity:1" />
              <stop offset="50%" style="stop-color:#FBBF24;stop-opacity:1" />
              <stop offset="75%" style="stop-color:#F59E0B;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#EF4444;stop-opacity:1" />
            </linearGradient>
          </defs>
        </svg>
      </div>
    </div>

    <!-- UV Index for Search -->
    <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4">
      <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">UV INDEX</p>
      <div class="mb-6">
        <p class="text-navy-50 font-bold text-4xl leading-none" style="letter-spacing: -0.36px;">{{ getSearchUVIndex() }}</p>
        <p class="text-navy-50 font-bold text-2xl lowercase" style="letter-spacing: -0.24px;">{{ getUVDescription(getSearchUVIndex()) }}</p>
      </div>
      
      <!-- UV Index gradient bar -->
      <div class="relative">
        <svg class="w-full h-4" viewBox="0 0 365 18" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0.339746 9L9 17.6603L17.6603 9L9 0.339746L0.339746 9ZM364.66 9L356 0.339746L347.34 9L356 17.6603L364.66 9ZM9 9V10.5H356V9V7.5H9V9Z" fill="url(#paint0_linear_uv_search)"/>
          
          <!-- UV indicator -->
          <circle 
            [attr.cx]="9 + (getUVPosition(getSearchUVIndex()) / 100) * 347" 
            cy="9" 
            r="7" 
            fill="#26658C"
            stroke="#FFFFFF"
            stroke-width="3"
            class="drop-shadow-lg"
          />
          
          <defs>
            <linearGradient id="paint0_linear_uv_search" x1="9" y1="17.5" x2="356" y2="17.5" gradientUnits="userSpaceOnUse">
              <stop stop-color="#268C48"/>
              <stop offset="0.0865385" stop-color="#C09A00"/>
              <stop offset="0.289568" stop-color="#CF5701"/>
              <stop offset="0.495192" stop-color="#D33335"/>
              <stop offset="0.732416" stop-color="#D8000B"/>
              <stop offset="0.913462" stop-color="#C00087"/>
              <stop offset="1" stop-color="#290140" stop-opacity="0.88"/>
            </linearGradient>
          </defs>
        </svg>
      </div>
    </div>

      <!-- Info Grid Row 2 for Search -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <!-- Visibility -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">VISIBILITY</p>
          <p class="text-navy-50 font-bold text-4xl mb-8" style="letter-spacing: -0.36px;">{{ searchWeatherData()!.weather.visibility }} km</p>
          <p class="text-navy-50 font-bold text-sm lowercase leading-tight">{{ searchWeatherData()!.weather.visibility > 10 ? 'Perfectly clear view.' : 'Limited visibility.' }}</p>
        </div>

        <!-- Precipitation Chances -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">CLOUDINESS</p>
          <div class="mb-2">
            <p class="text-navy-50 font-bold text-4xl leading-none" style="letter-spacing: -0.36px;">{{ getSearchCloudiness() }}%</p>
            <p class="text-navy-50 font-bold text-2xl" style="letter-spacing: -0.24px;">CLOUDS</p>
          </div>
        </div>
      </div>

      <!-- Info Grid Row 3 for Search -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <!-- Pressure -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">PRESSURE</p>
          <p class="text-navy-50 font-bold text-4xl mb-12" style="letter-spacing: -0.36px;">{{ searchWeatherData()!.weather.pressure }}</p>
          <p class="text-navy-50 font-bold text-sm lowercase text-right">mbar</p>
        </div>

        <!-- Humidity -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">HUMIDITY</p>
          <p class="text-navy-50 font-bold text-4xl mb-8" style="letter-spacing: -0.36px;">{{ searchWeatherData()!.weather.humidity }}%</p>
          <p class="text-navy-50 font-bold text-sm lowercase leading-tight">{{ searchWeatherData()!.weather.humidity > 70 ? 'high humidity' : 'moderate humidity' }}</p>
        </div>
      </div>
    }

    <!-- Weather Content for Historical (Page 3) -->
    @if (currentPage() === 3 && historicalWeatherData() && !loading()) {
      <!-- Header -->
      <div class="text-center mb-4">
        <p class="text-navy-90 font-bold text-sm uppercase tracking-tight" style="letter-spacing: -1.05px;">{{ getHistoricalDateType() }} WEATHER</p>
        <h1 class="text-navy font-bold text-4xl uppercase" style="letter-spacing: -2.52px;">{{ getHistoricalLocationDisplayName() }}</h1>
        <p class="text-navy-50 font-bold text-xs mt-2">{{ getHistoricalFormattedDate() }}</p>
      </div>

      <!-- Current Weather Card -->
      <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4 relative">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-4">
            <!-- Weather icon removed for historical page -->
            <div>
              @if (historicalWeatherData()!.temperature.current !== undefined) {
                <p class="text-navy-90 font-bold text-4xl" style="letter-spacing: -2.52px;">{{ historicalWeatherData()!.temperature.current }}°C</p>
                <p class="text-navy-90 font-bold text-sm" style="letter-spacing: -1.05px;">{{ historicalWeatherData()!.weather?.description || 'Weather data' }}</p>
                @if (historicalWeatherData()!.temperature.feels_like !== undefined) {
                  <p class="text-navy-90 font-bold text-2xl" style="letter-spacing: -1.68px;">Feels like {{ historicalWeatherData()!.temperature.feels_like }}°</p>
                }
              } @else {
                <p class="text-navy-90 font-bold text-4xl" style="letter-spacing: -2.52px;">{{ historicalWeatherData()!.temperature.max }}°C</p>
                <p class="text-navy-90 font-bold text-sm" style="letter-spacing: -1.05px;">Daily Summary</p>
              }
              <p class="text-navy-90 font-bold text-2xl" style="letter-spacing: -1.68px;">H:{{ historicalWeatherData()!.temperature.max }}°</p>
              <p class="text-navy-90 font-bold text-2xl" style="letter-spacing: -1.68px;">L:{{ historicalWeatherData()!.temperature.min }}°</p>
            </div>
          </div>
          <img 
            [src]="getHistoricalWeatherGoatImage()" 
            alt="Weather goat" 
            class="w-[142px] h-auto absolute right-4 top-8"
          />
        </div>
      </div>

      <!-- Time-of-day temperatures (for daily summary) -->
      @if (historicalWeatherData()!.temperature.afternoon !== undefined) {
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">Daily temperatures</p>
          <div class="grid grid-cols-2 gap-4">
            <div class="text-center">
              <p class="text-navy-50 font-bold text-xs mb-1">Morning</p>
              <p class="text-navy-50 font-bold text-2xl">{{ historicalWeatherData()!.temperature.morning }}°</p>
            </div>
            <div class="text-center">
              <p class="text-navy-50 font-bold text-xs mb-1">Afternoon</p>
              <p class="text-navy-50 font-bold text-2xl">{{ historicalWeatherData()!.temperature.afternoon }}°</p>
            </div>
            <div class="text-center">
              <p class="text-navy-50 font-bold text-xs mb-1">Evening</p>
              <p class="text-navy-50 font-bold text-2xl">{{ historicalWeatherData()!.temperature.evening }}°</p>
            </div>
            <div class="text-center">
              <p class="text-navy-50 font-bold text-xs mb-1">Night</p>
              <p class="text-navy-50 font-bold text-2xl">{{ historicalWeatherData()!.temperature.night }}°</p>
            </div>
          </div>
        </div>
      }

      <!-- Precipitation Map (only for present day) -->
      @if (historicalWeatherData()!.type === 'present' && historicalLocation()) {
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">Precipitation</p>
          <div class="w-full h-[259px] rounded-[20px] overflow-hidden">
            <iframe 
              [src]="getHistoricalWindyMapUrl()"
              width="100%" 
              height="100%" 
              frameborder="0"
              class="rounded-[20px]"
              allowfullscreen>
            </iframe>
          </div>
        </div>
      }

      <!-- Info Grid Row 1 -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <!-- Feels Like (for present day) -->
        @if (historicalWeatherData()!.temperature.feels_like !== undefined) {
          <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
            <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">FEELS LIKE</p>
            <p class="text-navy-50 font-bold text-4xl mb-1" style="letter-spacing: -0.36px;">{{ historicalWeatherData()!.temperature.feels_like }}°</p>
            <p class="text-navy-50 font-bold text-sm lowercase mb-2">actual: {{ historicalWeatherData()!.temperature.current }}°</p>
            <div class="flex items-center gap-2 mb-2">
              <p class="text-navy-50 font-bold text-sm lowercase">{{ Math.abs((historicalWeatherData()!.temperature.current ?? 0) - (historicalWeatherData()!.temperature.feels_like ?? 0)) }}°</p>
              <svg class="w-3 h-3" [class.rotate-90]="(historicalWeatherData()!.temperature.feels_like ?? 0) < (historicalWeatherData()!.temperature.current ?? 0)" [class.-rotate-90]="(historicalWeatherData()!.temperature.feels_like ?? 0) > (historicalWeatherData()!.temperature.current ?? 0)" viewBox="0 0 12 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M7 1C7 0.447715 6.55228 0 6 0C5.44772 0 5 0.447715 5 1H6L7 1ZM6 20.7735L11.7735 15L6 9.2265L0.226497 15L6 20.7735ZM6 1H5L5 15H6H7L7 1L6 1Z" fill="#46738B"/>
              </svg>
            </div>
            <div class="h-px bg-gradient-to-r from-navy to-cyan-light/40 mb-2"></div>
            <p class="text-navy-50 font-bold text-xs lowercase leading-tight">
              {{ (historicalWeatherData()!.temperature.feels_like ?? 0) < (historicalWeatherData()!.temperature.current ?? 0) ? 'It feels colder than the actual temperature' : 'It feels warmer than the actual temperature' }}
            </p>
          </div>
        } @else {
          <!-- Wind for historical data -->
          <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
            <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">WIND</p>
            <p class="text-navy-50 font-bold text-4xl mb-4" style="letter-spacing: -0.36px;">{{ historicalWeatherData()!.wind.speed }}</p>
            <p class="text-navy-50 font-bold text-sm lowercase">m/s</p>
            @if (historicalWeatherData()!.wind.direction !== undefined) {
              <p class="text-navy-50 font-bold text-xs mt-2">{{ historicalWeatherData()!.wind.direction }}°</p>
            }
          </div>
        }

        <!-- Elevation (for present day) or Precipitation (for historical) -->
        @if (historicalWeatherData()!.type === 'present') {
          <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
            <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">ELEVATION</p>
            <p class="text-navy-50 font-bold text-4xl mb-1" style="letter-spacing: -0.36px;">{{ historicalWeatherData()!.elevation?.elevation || 'N/A' }}</p>
            <p class="text-navy-50 font-bold text-sm lowercase mb-2">meter</p>
            <p class="text-navy-50 font-bold text-sm lowercase leading-tight mb-1">above sea level</p>
            <p class="text-navy-50 font-bold text-xs uppercase leading-tight">{{ formatCoordinates(historicalWeatherData()!.location.lat, historicalWeatherData()!.location.lon).lat }}<br>{{ formatCoordinates(historicalWeatherData()!.location.lat, historicalWeatherData()!.location.lon).lng }}</p>
          </div>
        } @else {
          <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
            <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">PRECIPITATION</p>
            <p class="text-navy-50 font-bold text-4xl mb-4" style="letter-spacing: -0.36px;">{{ historicalWeatherData()!.precipitation || 0 }} mm</p>
            <p class="text-navy-50 font-bold text-sm lowercase leading-tight">{{ (historicalWeatherData()!.precipitation ?? 0) > 0 ? 'precipitation recorded' : 'no precipitation' }}</p>
          </div>
        }
      </div>

      <!-- Sunrise and Sunset (for present day) -->
      @if (historicalWeatherData()!.type === 'present') {
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4 relative">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">SUNRISE AND SUNSET</p>
          <div class="flex items-center justify-between mb-8">
            <p class="text-navy-50 font-bold text-4xl" style="letter-spacing: -0.36px;">06:30</p>
          </div>
          <p class="text-navy-50 font-bold text-sm capitalize absolute bottom-4 right-4" style="letter-spacing: -0.15px;">Sunset: 18:30</p>
        
        <!-- Sunset indicator bar -->
        <div class="relative mt-4">
          <svg class="w-full h-4" viewBox="0 0 365 18" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M0.339746 9L9 17.6603L17.6603 9L9 0.339746L0.339746 9ZM364.66 9L356 0.339746L347.34 9L356 17.6603L364.66 9ZM9 9V10.5H356V9V7.5H9V9Z" fill="url(#paint0_linear_sunset_hist)"/>
            <defs>
              <linearGradient id="paint0_linear_sunset_hist" x1="9" y1="17.5" x2="356" y2="17.5" gradientUnits="userSpaceOnUse">
                <stop stop-color="#26658C"/>
                <stop offset="0.0865385" stop-color="#C09A00"/>
                <stop offset="0.370192" stop-color="#FFEA00"/>
                <stop offset="0.495192" stop-color="#FFF49A"/>
                <stop offset="0.586538" stop-color="#FFE000"/>
                <stop offset="0.913462" stop-color="#C09A00"/>
                <stop offset="1" stop-color="#011C40" stop-opacity="0.88"/>
              </linearGradient>
            </defs>
          </svg>
          <!-- Sun position indicator -->
          <svg class="absolute -top-2 right-[20px]" style="transform: rotate(-90deg)" width="12" height="17" viewBox="0 0 12 17" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M6 0.226498L0.226497 6L6 11.7735L11.7735 6L6 0.226498ZM6 17L7 17L7 6L6 6L5 6L5 17L6 17Z" fill="#CFB005"/>
          </svg>
        </div>
      </div>
      }

      <!-- UV Index (for present day) -->
      @if (historicalWeatherData()!.type === 'present') {
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">UV INDEX</p>
          <div class="mb-6">
            <p class="text-navy-50 font-bold text-4xl leading-none" style="letter-spacing: -0.36px;">{{ historicalWeatherData()!.uvi || 1 }}</p>
            <p class="text-navy-50 font-bold text-2xl lowercase" style="letter-spacing: -0.24px;">low</p>
          </div>
          
          <!-- UV Index gradient bar -->
          <div class="relative">
            <svg class="w-full h-4" viewBox="0 0 365 18" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M0.339746 9L9 17.6603L17.6603 9L9 0.339746L0.339746 9ZM364.66 9L356 0.339746L347.34 9L356 17.6603L364.66 9ZM9 9V10.5H356V9V7.5H9V9Z" fill="url(#paint0_linear_uv_hist)"/>
              
              <!-- UV indicator -->
              <circle 
                [attr.cx]="9 + (getUVPosition(historicalWeatherData()!.uvi || 1) / 100) * 347" 
                cy="9" 
                r="7" 
                fill="#26658C"
                stroke="#FFFFFF"
                stroke-width="3"
                class="drop-shadow-lg"
              />
              
              <defs>
                <linearGradient id="paint0_linear_uv_hist" x1="9" y1="17.5" x2="356" y2="17.5" gradientUnits="userSpaceOnUse">
                  <stop stop-color="#268C48"/>
                  <stop offset="0.0865385" stop-color="#C09A00"/>
                  <stop offset="0.289568" stop-color="#CF5701"/>
                  <stop offset="0.495192" stop-color="#D33335"/>
                  <stop offset="0.732416" stop-color="#D8000B"/>
                  <stop offset="0.913462" stop-color="#C00087"/>
                  <stop offset="1" stop-color="#290140" stop-opacity="0.88"/>
                </linearGradient>
              </defs>
            </svg>
          </div>
        </div>
      }

      <!-- Info Grid Row 2 -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <!-- Visibility (for present day) or Wind (for historical) -->
        @if (historicalWeatherData()!.visibility !== undefined) {
          <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
            <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">VISIBILITY</p>
            <p class="text-navy-50 font-bold text-4xl mb-8" style="letter-spacing: -0.36px;">{{ historicalWeatherData()!.visibility }} km</p>
            <p class="text-navy-50 font-bold text-sm lowercase leading-tight">{{ (historicalWeatherData()!.visibility ?? 0) > 10 ? 'Perfectly clear view.' : 'Limited visibility.' }}</p>
          </div>
        } @else {
          <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
            <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">WIND</p>
            <p class="text-navy-50 font-bold text-4xl mb-4" style="letter-spacing: -0.36px;">{{ historicalWeatherData()!.wind.speed }}</p>
            <p class="text-navy-50 font-bold text-sm lowercase">m/s</p>
            @if (historicalWeatherData()!.wind.direction !== undefined) {
              <p class="text-navy-50 font-bold text-xs mt-2">{{ historicalWeatherData()!.wind.direction }}°</p>
            }
          </div>
        }

        <!-- Cloudiness -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">CLOUDINESS</p>
          <div class="mb-2">
            <p class="text-navy-50 font-bold text-4xl leading-none" style="letter-spacing: -0.36px;">{{ historicalWeatherData()!.cloudiness }}%</p>
            <p class="text-navy-50 font-bold text-2xl" style="letter-spacing: -0.24px;">CLOUDS</p>
          </div>
        </div>
      </div>

      <!-- Info Grid Row 3 -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <!-- Pressure -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">PRESSURE</p>
          <p class="text-navy-50 font-bold text-4xl mb-12" style="letter-spacing: -0.36px;">{{ historicalWeatherData()!.pressure }}</p>
          <p class="text-navy-50 font-bold text-sm lowercase text-right">mbar</p>
        </div>

        <!-- Humidity -->
        <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4">
          <p class="text-navy-50 font-bold text-xs uppercase mb-2" style="letter-spacing: -0.11px;">HUMIDITY</p>
          <p class="text-navy-50 font-bold text-4xl mb-8" style="letter-spacing: -0.36px;">{{ historicalWeatherData()!.humidity }}%</p>
          <p class="text-navy-50 font-bold text-sm lowercase leading-tight">{{ historicalWeatherData()!.humidity > 70 ? 'high humidity' : 'moderate humidity' }}</p>
        </div>
      </div>
    }

    <!-- Page indicator -->
    <div class="flex justify-center gap-3 mb-4">
      @for (page of [0, 1, 2, 3]; track page) {
        <button 
          (click)="goToPage(page)"
          class="w-6 h-6 rounded-full transition-all duration-200"
          [class]="currentPage() === page ? 'bg-goat-blue/80 border border-white/15' : 'bg-gray-300/80'">
          @if (page === 2) {
            <div class="w-full h-full flex items-center justify-center">
              <div class="w-0.5 h-3 bg-goat-teal"></div>
              <div class="w-3 h-0.5 bg-goat-teal absolute"></div>
            </div>
          }
          @if (page === 3) {
            <div class="w-full h-full flex items-center justify-center">
              <svg class="w-3 h-3" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="2" y="3" width="12" height="11" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
                <line x1="2" y1="6" x2="14" y2="6" stroke="currentColor" stroke-width="1.5"/>
                <line x1="5" y1="1" x2="5" y2="4" stroke="currentColor" stroke-width="1.5"/>
                <line x1="11" y1="1" x2="11" y2="4" stroke="currentColor" stroke-width="1.5"/>
              </svg>
            </div>
          }
        </button>
      }
    </div>
  </div>

  <app-navigation></app-navigation>
</div>