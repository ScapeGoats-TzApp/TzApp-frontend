<div class="min-h-screen pb-24">
  <div class="max-w-[412px] mx-auto px-[6px] pt-8">
    
    <!-- Profile Avatar -->
    <div class="flex justify-center mb-8">
      <div class="relative w-[185px] h-[185px]">
        <img 
          [src]="getProfilePicPath(selectedProfilePic())" 
          alt="Profile" 
          class="avatar-image cursor-pointer hover:opacity-80 transition-opacity"
          (click)="openProfilePicSelector()"
        />
        <!-- Edit icon overlay -->
        <div class="absolute bottom-2 right-2 w-8 h-8 bg-white/90 rounded-full flex items-center justify-center shadow-lg">
          <svg class="w-4 h-4 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/>
          </svg>
        </div>
      </div>
    </div>

    <!-- Profile Name -->
    <div class="flex items-center justify-center gap-2 mb-6">
      @if (!isEditingName()) {
        <h1 class="text-white font-bold text-4xl capitalize text-center" style="text-shadow: 0 2px 7px #011C40; letter-spacing: 0px;">
          {{ userName() }}
        </h1>
        <button 
          (click)="startEditingName()"
          class="w-8 h-8 flex items-center justify-center hover:bg-white/20 rounded-lg transition-colors"
        >
          <img 
            src="https://api.builder.io/api/v1/image/assets/TEMP/64f0c9b624f366871a36a5b9bae1ede42bf8d9f4?width=66" 
            alt="Edit" 
            class="w-8 h-8"
          />
        </button>
      } @else {
        <div class="flex flex-col sm:flex-row items-center gap-2">
          <input 
            type="text" 
            [(ngModel)]="tempUserName"
            class="text-white font-bold text-4xl capitalize text-center bg-transparent border-b-2 border-white/50 focus:border-white focus:outline-none px-2 py-1"
            style="text-shadow: 0 2px 7px #011C40; letter-spacing: 0px; min-width: 200px; max-width: 100%;"
            placeholder="Enter name"
            (keydown.enter)="saveUserName()"
            (keydown.escape)="cancelEditingName()"
            #nameInput
          />
          <div class="flex items-center gap-2">
            <button 
              (click)="saveUserName()"
              class="w-8 h-8 flex items-center justify-center bg-green-500/80 hover:bg-green-500 rounded-lg transition-colors"
              title="Save"
            >
              <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
            </button>
            <button 
              (click)="cancelEditingName()"
              class="w-8 h-8 flex items-center justify-center bg-red-500/80 hover:bg-red-500 rounded-lg transition-colors"
              title="Cancel"
            >
              <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
        </div>
      }
    </div>

    <!-- Theme Toggle -->
      <!-- <div class="flex items-center justify-center gap-8 mb-4">
        <span class="text-navy-90 font-bold text-2xl uppercase" style="letter-spacing: -0.24px;">THEME</span>
        <div class="relative">
          <input type="checkbox" id="dark-mode-toggle" [checked]="isDarkTheme()" (change)="toggleTheme()" class="sr-only">
            <label for="dark-mode-toggle" class="toggle" style="display: inline-block; width: 60px; height: 30px; background: #adbcdb; border-radius: 30px; position: relative; cursor: pointer; border: 2px solid #1e2223;">
              <span style="position: absolute; top: 3px; left: 5px; width: 20px; height: 20px; background: #ffffff; border-radius: 50%; transition: transform 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.2);"></span>
            </label>
        </div>
      </div> -->

    <!-- Terms and Conditions -->
    <button 
      (click)="openTermsPopup()"
      class="w-full bg-cyan-light/20 rounded-[30px] border-b border-cyan p-5 mb-4 flex items-center justify-between hover:bg-cyan-light/30 transition-colors"
    >
      <span class="text-navy-90 font-bold text-2xl uppercase align-middle" style="letter-spacing: -0.24px;">TERMS AND CONDITIONS</span>
      <svg class="w-3 h-4" viewBox="0 0 13 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12.7071 8.70711C13.0976 8.31658 13.0976 7.68342 12.7071 7.29289L6.34315 0.928932C5.95262 0.538408 5.31946 0.538408 4.92893 0.928932C4.53841 1.31946 4.53841 1.95262 4.92893 2.34315L10.5858 8L4.92893 13.6569C4.53841 14.0474 4.53841 14.6805 4.92893 15.0711C5.31946 15.4616 5.95262 15.4616 6.34315 15.0711L12.7071 8.70711ZM0 8V9H12V8V7H0V8Z" fill="#163252"/>
      </svg>
    </button>

    <!-- Review Section -->
    <div class="relative">
      <div class="bg-cyan-light/20 rounded-[20px] border-b border-cyan p-4 mb-4">
        <!-- Title -->
        <h2 class="text-navy-90 font-bold text-2xl uppercase text-left mb-2" style="letter-spacing: -0.24px;">
          LEAVE US A REVIEW...
        </h2>
        
        <!-- Subtitle -->
        <!-- <p class="text-navy-50 font-bold text-xs uppercase text-center" style="letter-spacing: -0.11px; line-height: 10px;">
          WE'D LOVE TO HEAR FROM YOU!
        </p> -->

        <!-- Text Area -->
        <textarea 
          [value]="reviewText()"
          (input)="onReviewTextChange($event)"
          placeholder="Type your feedback here..." 
          class="w-full h-[200px] bg-transparent text-navy-50 font-bold text-xs placeholder:text-navy-50 placeholder:uppercase focus:outline-none resize-none mt-2"
          style="letter-spacing: -0.11px; line-height: 10px;"
        ></textarea>
      </div>

      <!-- Send Button -->
      <div class="flex justify-center">
        @if (reviewSent()) {
          <div class="bg-green-500/20 rounded-[20px] border-b border-green-500 px-6 py-2 mt-1 flex items-center gap-2">
            <svg class="w-6 h-6 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
            <span class="text-green-500 font-bold text-base uppercase" style="letter-spacing: -0.16px; line-height: 10px;">
              SENT!
            </span>
          </div>
        } @else {
          <button 
            (click)="sendReview()"
            [disabled]="isSendingReview() || !reviewText().trim()"
            class="bg-white/20 rounded-[20px] border-b border-cyan px-6 py-2 flex items-center gap-2 hover:bg-white/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
          >
            @if (isSendingReview()) {
              <div class="w-6 h-6">
                <svg class="animate-spin h-6 w-6 text-navy-50" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
              </div>
            } @else {
              <img 
                src="https://api.builder.io/api/v1/image/assets/TEMP/bc97444f011c4f2b7f56e02bc04bdbf5c2588b27?width=48" 
                alt="Send" 
                class="w-6 h-6"
              />
            }
            <span class="text-navy-50 font-bold text-base uppercase" style="letter-spacing: -0.16px; line-height: 10px;">
              @if (isSendingReview()) {
                SENDING...
              } @else {
                SEND
              }
            </span>
          </button>
        }
      </div>
    </div>

  </div>

  <!-- Terms and Conditions Popup -->
  @if (showTermsPopup()) {
    <div class="fixed inset-0 z-50 flex items-center justify-center p-4">
      <!-- Backdrop -->
      <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" (click)="closeTermsPopup()"></div>
      
      <!-- Popup Content -->
      <div class="relative bg-white/95 backdrop-blur-sm rounded-[20px] border border-cyan shadow-2xl max-w-[90vw] max-h-[90vh] overflow-hidden">
        <!-- Header -->
        <div class="bg-cyan-light/20 text-center border-b border-cyan p-4 flex items-center justify-between">
          <h2 class="text-navy-90 font-bold text-2xl uppercase" style="letter-spacing: -0.24px;">
            TERMS AND CONDITIONS
          </h2>
          <button 
            (click)="closeTermsPopup()"
            class="w-8 h-8 flex items-center justify-center hover:bg-white/30 rounded-lg transition-colors"
          >
            <svg class="w-6 h-6 text-navy" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
        
        <!-- Content -->
        <div class="p-6 overflow-y-auto max-h-[70vh]">
          <div class="space-y-4 text-navy-70">
            <div>
              <h3 class="text-navy-90 font-bold text-lg mb-2">1. Acceptance of Terms</h3>
              <p class="text-sm leading-relaxed">By accessing and using TzApp, you agree to these Terms and Conditions. If you do not agree, you are not authorized to use the application.</p>
            </div>
            
            <div>
              <h3 class="text-navy-90 font-bold text-lg mb-2">2. Service Overview</h3>
              <p class="text-sm leading-relaxed mb-2">TzApp offers the following features:</p>
              <ul class="text-sm leading-relaxed ml-4 space-y-1">
                <li>• <strong>Weather Prediction Chatbot:</strong> Provides personalized weather forecasts for events, vacations, and flights, using real-time data to offer location-specific recommendations.</li>
                <li>• <strong>Smart Planner:</strong> Assists in event planning by suggesting optimal times based on weather forecasts and calendar data.</li>
                <li>• <strong>Saved Locations:</strong> Users can save locations for easy access to detailed weather forecasts, which are stored locally on their devices.</li>
              </ul>
            </div>
            
            <div>
              <h3 class="text-navy-90 font-bold text-lg mb-2">3. Application Usage</h3>
              <p class="text-sm leading-relaxed mb-2">TzApp is for personal, non-commercial use only, including:</p>
              <ul class="text-sm leading-relaxed ml-4 space-y-1">
                <li>• Viewing weather forecasts</li>
                <li>• Interacting with the chatbot for personalized recommendations</li>
                <li>• Saving and viewing preferred locations</li>
              </ul>
            </div>
            
            <div>
              <h3 class="text-navy-90 font-bold text-lg mb-2">4. Privacy and Data Protection</h3>
              <p class="text-sm leading-relaxed">By using TzApp, you consent to our Privacy Policy, which details how we collect and protect personal data. We may collect information like location and user preferences to improve services. We do not sell or distribute personal data without explicit consent, unless required by law.</p>
            </div>
            
            <div>
              <h3 class="text-navy-90 font-bold text-lg mb-2">5. Limitation of Liability</h3>
              <p class="text-sm leading-relaxed">While we use reliable weather data, forecasts are estimates and not guaranteed. Users are responsible for not making critical decisions solely based on TzApp forecasts. We are not liable for any damages resulting from app usage.</p>
            </div>
            
            <div>
              <h3 class="text-navy-90 font-bold text-lg mb-2">6. Chatbot Functionality</h3>
              <p class="text-sm leading-relaxed">The chatbot provides event and vacation recommendations based on weather forecasts but does not replace expert consultation in extreme conditions. TzApp is not liable for decisions based on chatbot advice.</p>
            </div>
            
            <div>
              <h3 class="text-navy-90 font-bold text-lg mb-2">7. Modifications to Terms</h3>
              <p class="text-sm leading-relaxed">We may update these Terms at any time. Changes will be published within the app, and users will be notified. Continued use constitutes acceptance of the new terms.</p>
            </div>
            
            <div>
              <h3 class="text-navy-90 font-bold text-lg mb-2">8. Governing Law</h3>
              <p class="text-sm leading-relaxed">These Terms are governed by Romanian law. Any disputes will be resolved under Romanian legislation.</p>
            </div>
            
            <div>
              <h3 class="text-navy-90 font-bold text-lg mb-2">9. Dispute Resolution</h3>
              <p class="text-sm leading-relaxed">In case of a dispute, please contact TzApp for resolution. If unresolved, the matter will be handled under Romanian law.</p>
            </div>
            
            <div>
              <h3 class="text-navy-90 font-bold text-lg mb-2">10. Contact Us</h3>
              <p class="text-sm leading-relaxed">For questions about these Terms, please contact us at:</p>
              <p class="text-sm leading-relaxed mt-1"><strong>Phone:</strong> 0775336202</p>
            </div>
          </div>
        </div>
        
        <!-- Footer -->
        <div class="bg-cyan-light/10 border-t border-cyan p-4 flex justify-center">
          <button 
            (click)="closeTermsPopup()"
            class="bg-cyan-light/20 rounded-[20px] border-b border-cyan px-6 py-2 text-navy-90 font-bold text-base uppercase hover:bg-cyan-light/30 transition-colors"
            style="letter-spacing: -0.16px;"
          >
            CLOSE
          </button>
        </div>
      </div>
    </div>
  }

  <!-- Profile Picture Selection Modal -->
  @if (showProfilePicSelector()) {
    <div class="fixed inset-0 z-50 flex items-center justify-center p-4">
      <!-- Backdrop -->
      <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" (click)="closeProfilePicSelector()"></div>
      
      <!-- Modal Content -->
      <div class="relative bg-white/95 backdrop-blur-sm rounded-[20px] border border-cyan shadow-2xl max-w-[90vw] max-h-[90vh] overflow-hidden">
        <!-- Header -->
        <div class="bg-cyan-light/20 text-center border-b border-cyan p-4 flex items-center justify-between">
          <h2 class="text-navy-90 font-bold text-2xl uppercase" style="letter-spacing: -0.24px;">
            CHOOSE PROFILE PICTURE
          </h2>
          <button 
            (click)="closeProfilePicSelector()"
            class="w-8 h-8 flex items-center justify-center hover:bg-white/30 rounded-lg transition-colors"
          >
            <svg class="w-6 h-6 text-navy" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
        
        <!-- Profile Pictures Grid -->
        <div class="p-6">
          <div class="grid grid-cols-2 gap-4">
            @for (pic of availableProfilePics; track pic) {
              <div 
                class="relative cursor-pointer group"
                (click)="selectProfilePic(pic)"
              >
                <img 
                  [src]="getProfilePicPath(pic)" 
                  [alt]="'Profile ' + pic"
                  class="w-full h-32 object-cover rounded-lg border-2 transition-all duration-200"
                  [class.border-cyan]="selectedProfilePic() === pic"
                  [class.border-gray-300]="selectedProfilePic() !== pic"
                  [class.group-hover:border-cyan]="selectedProfilePic() !== pic"
                />
                @if (selectedProfilePic() === pic) {
                  <div class="absolute top-2 right-2 w-6 h-6 bg-cyan rounded-full flex items-center justify-center">
                    <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                    </svg>
                  </div>
                }
              </div>
            }
          </div>
        </div>
        
        <!-- Footer -->
        <div class="bg-cyan-light/10 border-t border-cyan p-4 flex justify-center">
          <button 
            (click)="closeProfilePicSelector()"
            class="bg-cyan-light/20 rounded-[20px] border-b border-cyan px-6 py-2 text-navy-90 font-bold text-base uppercase hover:bg-cyan-light/30 transition-colors"
            style="letter-spacing: -0.16px;"
          >
            DONE
          </button>
        </div>
      </div>
    </div>
  }

  <app-navigation></app-navigation>
</div>